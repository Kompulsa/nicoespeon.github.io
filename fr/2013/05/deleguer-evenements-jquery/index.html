<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0"><meta name="description" content="Un petit rappel sur les écouteurs d'événements et les bonnes pratiques de délégations en jQuery."><title>Déléguer les événements en jQuery | @nicoespeon</title><link rel="icon" href="/assets/img/icon.png"><link rel="author" href="https://plus.google.com/u/0/108378377887967941980"><!-- DNS prefetch for external resources --><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//platform.twitter.com"><link rel="dns-prefetch" href="//p.twitter.com"><link rel="dns-prefetch" href="//cdn.api.twitter.com"><link rel="dns-prefetch" href="//google-analytics.com"><link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Snippet|Roboto:300,100,700'><link rel="stylesheet" href="/assets/css/nicoespeon.css" media="screen"><link rel="stylesheet" href="/assets/css/nicoespeon-print.css" media="print"></head><body><div id="site"><div class="container"><div class="grid"><div class="grid__item seven-tenths portable-one-whole" role="main"><header class="media" role="banner"><!-- Brand logo --><img src="http://www.gravatar.com/avatar/46978c87c5c75cea5d05a61fa8b7d95b" class="media__img img--circle" alt="My avatar" width="80" height="80" /><!-- Main navigation --><nav class="media__body" role="navigation"><ul class="nav nav--main"><li><a href="/fr/index.html">Accueil</a></li><li><a href="/fr/about.html">À propos</a></li><li><a href="/fr/projects.html">Projets</a></li><li><a href="/fr/worth-reading.html">A Lire</a></li><li><a href="/fr/prestations.html">Prestations</a></li></ul></nav><!-- /navigation --></header><!-- /header --><article role="main"><h1>Déléguer les événements en jQuery</h1><div class="media"><a href="https://twitter.com/share" class="twitter-share-button media__img--rev" data-text="Déléguer les événements en jQuery |" data-via="nicoespeon">Tweeter</a><div class="media__body brand-face zeta">(13 Mai, 2013)</div></div><p class="islet">Un petit rappel sur les écouteurs d'événements et les bonnes pratiques de délégations en jQuery.</p><h2 id='tldr'>TL;DR</h2><p>Jusqu&#8217;à <strong>jQuery 1.7</strong> on faisait la distinction entre <code>$.fn.bind</code>, <code>$.fn.live</code> et <code>$.fn.delegate</code> afin de créer des écouteurs d&#8217;événements.</p><p><code>$.fn.bind</code> est la manière la plus basique d&#8217;attacher un écouteur à un objet, généralement un noeud du DOM.</p><p><code>$.fn.live</code> est plus puissant car il attache l&#8217;écouteur à la racine du document et fait <em>vivre</em> le comportement sur chaque élément du DOM correspondant, y compris ceux créés par la suite.</p><p><code>$.fn.delegate</code> se comporte plus ou moins comme <code>$.fn.live</code> à ceci près que l&#8217;on spécifie un noeud du DOM où l&#8217;on attache notre écouteur <em>live</em>, ce qui est bien plus rapide à l&#8217;exécution.</p><p><code>$.fn.delegate</code> est plus performant que <code>$.fn.live</code> qui est plus performant que <code>$.fn.bind</code>.</p><p>Depuis <strong>jQuery 1.7</strong>, toutes ces méthodes ont étés remplacées par l&#8217;unique méthode <code>$.fn.on</code>. Les principes de performance sont les mêmes, seule la syntaxe change.</p><h2 id='never_gonna__you_up'>Never gonna <code>bind</code> you up</h2><p>C&#8217;est la méthode la plus élémentaire pour attacher un écouteur d&#8217;événements à un objet jQuery. Elle est généralement utilisée sur des éléments du DOM dans le but de créer des intéractions avec l&#8217;utilisateur :</p><div class='highlight'><pre><code class='javascript'><span class='c1'>// Utilisation basique de $.fn.bind</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;div#main-content&#39;</span><span class='p'>).</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;click&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
</code></pre></div><p>Notre objet écoute désormais l&#8217;événement nommé <code>&#39;click&#39;</code> et réagira à chaque fois que cet événement sera déclenché. Sur l&#8217;exemple précédent par exemple, la fonction définie sera déclenchée à chaque fois que l&#8217;on cliquera sur l&#8217;élément <code>#main-content</code>.</p><p><code>&#39;click&#39;</code> est l&#8217;un des noms d&#8217;événements usuels qui dispose d&#8217;une méthode raccourcie équivalente :</p><div class='highlight'><pre><code class='javascript'><span class='c1'>// Équivalent du code précédent</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;div#main-content&#39;</span><span class='p'>).</span><span class='nx'>click</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
</code></pre></div><p>Cependant, il est possible de spécifier n&#8217;importe quel nom d&#8217;événement utilisé dans le code. En fait, c&#8217;est le point de départ de la <a href='http://fr.wikipedia.org/wiki/Programmation_%C3%A9v%C3%A9nementielle'>programmation événementielle</a> en JS, permettant de créer des applications web avancées.</p><div class='highlight'><pre><code class='javascript'><span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;#foo&#39;</span><span class='p'>).</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;my-event&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;#foo&#39;</span><span class='p'>).</span><span class='nx'>trigger</span><span class='p'>(</span><span class='s1'>&#39;my-event&#39;</span><span class='p'>);</span>  <span class='c1'>// Déclenchera l&#39;événement lié</span>
</code></pre></div><p class='islet'>La méthode pour arrêter un tel écouteur est <code>$.fn.unbind</code>.</p><p>Avant <strong>jQuery 1.7</strong>, c&#8217;était la manière la plus basique de faire les choses.</p><h2 id='born_to_be_a_'>Born to be a <code>live</code></h2><p>Bien que le principe de <code>$.fn.bind</code> soit sympatoche, la méthode est assez limitée. Typiquement, elle a deux inconvénients :</p><ol><li><p>Il attache un écouteur pour chacun des éléments qui correspondent au sélecteur, ce qui n&#8217;est pas la solution la plus optimale lorsque l&#8217;on cible plus d&#8217;un élément</p></li><li><p>Il attache un écouteur seuelement sur les éléments qui correspondent au sélecteur à ce moment précis, si vous modifiez le DOM et souhaitez créer de nouveaux éléments identiques, il vous faudra attacher les événements à nouveau.</p></li></ol><div class='highlight'><pre><code class='javascript'><span class='c1'>// Pas glop...</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;a.tooltip&#39;</span><span class='p'>).</span><span class='nx'>bind</span><span class='p'>(</span><span class='s1'>&#39;click&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
<span class='c1'>// ou $(&#39;a.tooltip&#39;).click(function() { ... });</span>
</code></pre></div><p>La solution développée avant <strong>jQuery 1.7</strong> était la méthode <code>$.fn.live</code> :</p><div class='highlight'><pre><code class='javascript'><span class='c1'>// Utilisation basique de $.fn.live</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;li.text-info&#39;</span><span class='p'>).</span><span class='nx'>live</span><span class='p'>(</span><span class='s1'>&#39;hover&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
</code></pre></div><p>Au lieu d&#8217;attacher un écouteur d&#8217;événements à chaque élément, il en attache un au niveau du <em>document root</em>. Ainsi, chaque nouvel élément qui correspond au sélecteur se comportera de la même manière. De plus, c&#8217;est <strong>bien plus efficace</strong> en termes de performance.</p><p class='islet'>La méthode pour arrêter un tel écouteur est <code>$.fn.die</code>.</p><p>Cette méthode est dépréciée depuis <strong>jQuery 1.7</strong>, mais le principe reste le même, ce qui est bon à savoir.</p><h2 id='learn_to_'>Learn to <code>delegate</code></h2><p>La méthode <code>$.fn.delegate</code> est basiquement la même que <code>$.fn.live</code>, présentant les mêmes avantages par rapport à <code>$.fn.bind</code>:</p><div class='highlight'><pre><code class='javascript'><span class='c1'>// Utilisation basique de $.fn.delegate</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;ul#main-navigation&#39;</span><span class='p'>).</span><span class='nx'>delegate</span><span class='p'>(</span><span class='s1'>&#39;li.text-info&#39;</span><span class='p'>,</span> <span class='s1'>&#39;hover&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
</code></pre></div><p>Le truc c&#8217;est que, au lieu d&#8217;attacher chaque écouteur au <em>document root</em>, vous spécifiez l&#8217;élément du DOM où vous souhaitez porter votre attention. Ainsi, vous <strong>augmentez significativement la performance</strong> car c&#8217;est bien plus spécifique !</p><p class='islet'>La méthode pour arrêter un tel écouteur est <code>$.fn.undelegate</code>.</p><h2 id='turn_me_'>Turn me <code>on</code></h2><p>Depuis <strong>jQuery 1.7</strong>, toutes les précédentes méthodes ont étés fusionnées dans une seule, puissante et unique méthode : <code>$.fn.on</code>.</p><p>Maintenant que vous avez compris comment les précédentes fonctionnent, voyons quels sont leur équivalent avec la syntaxe de celle-ci :</p><div class='highlight'><pre><code class='javascript'><span class='c1'>// Utilisation basique de $.fn.on au lieu de $.fn.bind</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;div#main-content&#39;</span><span class='p'>).</span><span class='nx'>on</span><span class='p'>(</span><span class='s1'>&#39;click&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>

<span class='c1'>// Utilisation basique de $.fn.on au lieu de $.fn.live</span>
<span class='nx'>$</span><span class='p'>(</span><span class='nb'>document</span><span class='p'>).</span><span class='nx'>on</span><span class='p'>(</span><span class='s1'>&#39;hover&#39;</span><span class='p'>,</span> <span class='s1'>&#39;li.text-info&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>

<span class='c1'>// Utilisation basique de $.fn.on au lieu de $.fn.delegate</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s1'>&#39;ul#main-nav&#39;</span><span class='p'>).</span><span class='nx'>on</span><span class='p'>(</span><span class='s1'>&#39;hover&#39;</span><span class='p'>,</span> <span class='s1'>&#39;li.text-info&#39;</span><span class='p'>,</span> <span class='kd'>function</span><span class='p'>()</span> <span class='p'>{</span> <span class='p'>...</span> <span class='p'>});</span>
</code></pre></div><p>La distinction entre <code>$.fn.live</code> et <code>$.fn.delegate</code> et plus claire avec cette simple méthode, l&#8217;accent mis sur la délégation prend son sens (sauf si vous souhaitez explicitement attacher votre écouteur à la racine du document, ce qui est rare).</p><p>Vous pouvez également passer des <strong>event data</strong> via la méthode :</p><div class='highlight'><pre><code class='javascript'><span class='c1'>// Attache des données à l&#39;événement</span>
<span class='nx'>$</span><span class='p'>(</span><span class='s2'>&quot;a&quot;</span><span class='p'>).</span><span class='nx'>each</span><span class='p'>(</span><span class='kd'>function</span><span class='p'>(</span><span class='nx'>i</span><span class='p'>)</span> <span class='p'>{</span>
    <span class='nx'>$</span><span class='p'>(</span><span class='k'>this</span><span class='p'>).</span><span class='nx'>on</span><span class='p'>(</span><span class='s1'>&#39;click&#39;</span><span class='p'>,</span> <span class='p'>{</span><span class='nx'>index</span><span class='o'>:</span><span class='nx'>i</span><span class='p'>},</span> <span class='kd'>function</span><span class='p'>(</span><span class='nx'>e</span><span class='p'>)</span> <span class='p'>{</span>
        <span class='nx'>alert</span><span class='p'>(</span><span class='s1'>&#39;My index is &#39;</span> <span class='o'>+</span> <span class='nx'>e</span><span class='p'>.</span><span class='nx'>data</span><span class='p'>.</span><span class='nx'>index</span><span class='p'>);</span>
    <span class='p'>});</span>
<span class='p'>});</span>
</code></pre></div><p>L&#8217;utilisation de <code>$.fn.on</code> est instinctive et rend la gestion événementielle très facile à prendre en main avec jQuery!</p><p class='islet'>La méthode pour arrêter un tel écouteur est... <code>$.fn.off</code>.</p><h2 id='et_pour_la_performance_'>Et pour la performance ?</h2><p>Comme expliqué, voici le listing des méthodes, de la plus performante à la moins performante :</p><ol><li><code>.on(events, selector, [data,] handler)</code> équivaut à <code>$.fn.delegate</code></li><li><code>$(document).on(events, selector, [data,] handler)</code> équivaut à <code>$.fn.live</code></li><li><code>.on(events, [data,] handler)</code> équivaut à <code>$.fn.bind</code></li></ol><p>Pour résumer :</p><ul><li>Si vous avez besoin d&#8217;attacher un écouteur d&#8217;événements à plus d&#8217;un élément, utilisez <code>.on(events, selector, [data,] handler)</code></li><li>Si vous n&#8217;avez pas d&#8217;ancre sur laquelle vous rattacher, utilisez <code>$(document).on(events, selector, [data,] handler)</code></li><li>Sinon, utilisez <code>.on(events, [data,] handler)</code>, ou la fonction raccourcie s&#8217;il y en a une</li></ul><h2 id='conclusion'>Conclusion</h2><p>C&#8217;était un bref et gentil rappel sur la délégation des événements en jQuery.</p><p>Rien de nouveau sous le soleil mais cette article traite d&#8217;un point important. C&#8217;est un point à savoir que vous pouvez facilement retrouver sur le net en faisant quelques recherches.</p><p>Je me suis rendu compte il y a quelque temps que j&#8217;avais la fâcheuse tendance de toujours utiliser la fonction raccourcie, même pour traiter un certain nombre d&#8217;éléments, alors que j&#8217;aurais pu employer des méthodes bien plus efficaces. <strong>Lorsque vous vous retrouvez à gérer plus d&#8217;un élément, pensez à la méthode <code>$.fn.on</code> !</strong></p><p>J&#8217;espère que ce petit point vous aura appris quelque chose ou rafraîchi la mémoire. Si c&#8217;est le cas, n&#8217;hésitez pas à me laisser votre opinion ci-dessous ;-)</p><p>Plop!</p><div id="disqus_thread" role="complementary"></div></article></div><div class="grid__item three-tenths portable-one-whole" role="complementary"><!-- Lang navigation --><nav role="navigation"><ul class="nav nav--stacked text--center"><li ><a href="/">English version</a></li><li class="current"><a href="/fr/">Version française</a></li></ul></nav><!-- About --><aside class="text--justify"><p>Je m'appelle <span class='brand-face'>Nicolas</span> et je suis étudiant d'une école de commerce orientée IT, développeur web en freelance à mes heures.</p><p>Je <a href='/archive'>rédige</a> des articles sur le développement web et la gestion de projets. Je suis <a href='http://www.linkedin.com/profile/view?id=143126897'>LinkedIn</a>, je <a href='https://delicious.com/nicoespeon'>tague</a> et je <a href='http://twitter.com/nicoespeon'>tweet</a> pas mal aussi.</p></aside><!-- RSS --><aside><p class="text--center"><a href="http://nicoespeon.com/feed.xml"><i class="icon-connection"></i>&nbsp;Restez connectés</a></p></aside><!-- Tweets --><aside class="text--center visuallyhidden--portable"><a class="twitter-timeline" href="https://twitter.com/nicoespeon" data-widget-id="320422386929377280">Tweets de @nicoespeon</a></aside></div></div></div><!-- /container --></div><!-- /main-content --><footer role="contentinfo"><div class="container"><p>&copy; 2013 - <a href="https://twitter.com/nicoespeon">Nicolas (Espeon) Carlo</a><br>Ce site est construit grâce à <a href='https://github.com/mojombo/jekyll'>Jekyll</a> et à <a href='http://inuitcss.com/'>inuit.css</a> de l'excellent <a href='https://twitter.com/csswizardry'>@csswizardry</a>. Le code source est <a href='https://github.com/nicoespeon/nicoespeon.github.io'>hébergé sur GitHub</a>.</p></div></footer><!-- jQuery --><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><script>$(function() {/*** This JS code is still small so its better to keep it inline.** Only apply if we are beyond the desk CSS breakpoint on load*/if($(window).width() >= 1024) {/*** Then hide every label description of the timeline*/$("ul#timeline").find("a.timeline__label").each(function() {$(this).find("p").hide();});/*** And delegate the visibility effect on hover for each label description*/$("ul#timeline").on("mouseenter mouseleave", "a.timeline__label", function() {$(this).find("p").stop().toggle("slow");});}});</script><!-- Twitter API --><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script><!-- Google Analytics --><script>var _gaq = _gaq || [];_gaq.push(['_setAccount', 'UA-39957541-2']);_gaq.push(['_setDomainName', 'nicoespeon.com']);_gaq.push(['_trackPageview']);(function() {var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script><!-- Disqus<script>var disqus_shortname = 'nicoespeon';var disqus_url = 'http://nicoespeon.com/fr/2013/05/deleguer-evenements-jquery';var title = "Déléguer les événements en jQuery";(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> --></body></html>